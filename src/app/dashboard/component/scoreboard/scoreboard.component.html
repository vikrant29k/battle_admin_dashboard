<div class="container">
  <div class="header-tag">
    <h2>Sales Data</h2>
    <p> Upload Hourly Excel File for Sales Updates</p>
  </div>

  <div class="upload-section">
    <!-- <h2 class="header-title">Upload File</h2> -->
    <div class="file-selection">
      <h3>Select a file to upload from your computer or device</h3>
      <div class="file-chooser">
        <input
          type="file"
          #fileInput
          style="display: none"
          accept=".xlsx, .xls"
          (change)="onFileSelected($event)"
        />

        <button
          mat-raised-button
          color="primary"
          (click)="fileInput.click()"
          *ngIf="!fileSelectedSpinner"
        >
          Choose a File
        </button>
        <mat-spinner
          style="width: 50px"
          *ngIf="fileSelectedSpinner"
        ></mat-spinner>
      </div>
      <!-- Display the selected file name -->
      <p
        *ngIf="selectedFile"
        [class.colorRed]="fileError"
        class="selected-file-name"
        style="margin-bottom: 0%"
      >
        Selected File: {{ selectedFile.name }}
      </p>

      <br />
      <div class="confirm-button">
        <button
          mat-raised-button
          (click)="onFileUpload()"
          [disabled]="disableConfirmButotn"
        >
          Confirm
        </button>
        <mat-spinner style="width: 50px" *ngIf="confirm"></mat-spinner>
      </div>
    </div>
  </div>

  <div class="table">
    <div class="tableContainer">
      <table>
        <thead>
          <tr>
            <td *ngFor="let header of headers">{{header}}</td>
            <td *ngIf="fileData?.length>0">Action</td>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of fileData; let i = index">
            <td>{{item["Company ID"]}}</td>
            <td>{{item["Sales rep no."]}}</td>
            <td>{{item["Sales in LC"]}}</td>
            <td class="action-column" style="position: sticky; right: 0;">
              <button mat-icon-button matTooltip="Edit" (click)="editLine(i)" style="background-color: #f0f0f0;">
                  <mat-icon>edit</mat-icon>
              </button>
          </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

</div>
